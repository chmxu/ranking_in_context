This repo contains codes for our NeurIPS 2024 paper "Towards Global Optimal Visual In-Context Learning Prompt Selection". The training and testing pipeline mainly follow the previous work [VPR](https://github.com/ZhangYuanhan-AI/visual_prompt_retrieval). **Unfortunately I have been busy on other stuff and I cannot provide a cleaner version of my code.** The basic idea can still be found in current snippets and hopefully I will have time for a better version.